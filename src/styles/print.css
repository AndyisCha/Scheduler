/* Print-specific styles for best-in-class readability */

/* ===== PRINT RESET ===== */
@media print {
  * {
    -webkit-print-color-adjust: exact !important;
    color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  /* Remove interactive elements from print */
  button,
  input,
  select,
  textarea,
  .no-print,
  .metrics-panel,
  .action-bar,
  .tab-navigation,
  nav,
  .navigation,
  .header-actions,
  .print-hidden {
    display: none !important;
  }

  /* Hide scrollbars and overflow */
  body {
    overflow: visible !important;
  }

  /* Remove shadows and effects */
  * {
    box-shadow: none !important;
    text-shadow: none !important;
    filter: none !important;
  }
}

/* ===== PAGE LAYOUT ===== */
@media print {
  @page {
    margin: 0.75in;
    size: A4;
    
    @top-left {
      content: "스케줄 관리 시스템";
      font-family: 'Pretendard', sans-serif;
      font-size: 10pt;
      color: #666;
    }
    
    @top-right {
      content: "생성일: " date();
      font-family: 'Pretendard', sans-serif;
      font-size: 10pt;
      color: #666;
    }
    
    @bottom-center {
      content: "페이지 " counter(page) " / " counter(pages);
      font-family: 'Pretendard', sans-serif;
      font-size: 10pt;
      color: #666;
    }
  }

  body {
    font-family: 'Pretendard', sans-serif !important;
    font-size: 12pt !important;
    line-height: 1.4 !important;
    color: #000 !important;
    background: #fff !important;
  }
}

/* ===== TYPOGRAPHY ===== */
@media print {
  h1 {
    font-size: 18pt !important;
    font-weight: 700 !important;
    margin: 0 0 12pt 0 !important;
    page-break-after: avoid !important;
    color: #000 !important;
  }

  h2 {
    font-size: 16pt !important;
    font-weight: 600 !important;
    margin: 16pt 0 8pt 0 !important;
    page-break-after: avoid !important;
    color: #000 !important;
  }

  h3 {
    font-size: 14pt !important;
    font-weight: 600 !important;
    margin: 12pt 0 6pt 0 !important;
    page-break-after: avoid !important;
    color: #000 !important;
  }

  h4 {
    font-size: 13pt !important;
    font-weight: 600 !important;
    margin: 10pt 0 4pt 0 !important;
    page-break-after: avoid !important;
    color: #000 !important;
  }

  p {
    font-size: 12pt !important;
    margin: 0 0 8pt 0 !important;
    orphans: 2 !important;
    widows: 2 !important;
  }

  .print-title {
    font-size: 20pt !important;
    font-weight: 700 !important;
    text-align: center !important;
    margin: 0 0 16pt 0 !important;
    page-break-after: always !important;
  }

  .print-subtitle {
    font-size: 14pt !important;
    font-weight: 500 !important;
    text-align: center !important;
    margin: 0 0 20pt 0 !important;
    color: #666 !important;
  }
}

/* ===== SCHEDULE TABLES ===== */
@media print {
  .schedule-table,
  .print-table {
    width: 100% !important;
    border-collapse: collapse !important;
    margin: 0 0 16pt 0 !important;
    page-break-inside: avoid !important;
    font-size: 11pt !important;
  }

  .schedule-table th,
  .print-table th {
    background: #f5f5f5 !important;
    border: 1pt solid #000 !important;
    padding: 6pt 8pt !important;
    font-weight: 600 !important;
    text-align: center !important;
    font-size: 10pt !important;
    page-break-after: avoid !important;
  }

  .schedule-table td,
  .print-table td {
    border: 1pt solid #000 !important;
    padding: 6pt 8pt !important;
    text-align: center !important;
    vertical-align: top !important;
    font-size: 10pt !important;
    page-break-inside: avoid !important;
  }

  .schedule-table tr,
  .print-table tr {
    page-break-inside: avoid !important;
    page-break-after: auto !important;
  }

  /* Highlight important cells */
  .schedule-table .assignment-cell,
  .print-table .assignment-cell {
    background: #fff !important;
    font-weight: 500 !important;
  }

  .schedule-table .period-header,
  .print-table .period-header {
    background: #e5e5e5 !important;
    font-weight: 600 !important;
  }

  .schedule-table .teacher-name,
  .print-table .teacher-name {
    font-weight: 500 !important;
  }

  .schedule-table .class-id,
  .print-table .class-id {
    font-weight: 600 !important;
    color: #000 !important;
  }

  /* Role indicators */
  .role-homeroom {
    background: #e3f2fd !important;
    border-left: 3pt solid #2196f3 !important;
  }

  .role-korean {
    background: #f3e5f5 !important;
    border-left: 3pt solid #9c27b0 !important;
  }

  .role-foreign {
    background: #e8f5e8 !important;
    border-left: 3pt solid #4caf50 !important;
  }
}

/* ===== CARDS AND CONTAINERS ===== */
@media print {
  .card,
  .print-card {
    border: 1pt solid #000 !important;
    margin: 0 0 12pt 0 !important;
    padding: 12pt !important;
    page-break-inside: avoid !important;
    background: #fff !important;
  }

  .card-header,
  .print-card-header {
    border-bottom: 1pt solid #000 !important;
    margin: 0 0 8pt 0 !important;
    padding: 0 0 6pt 0 !important;
    font-weight: 600 !important;
    font-size: 13pt !important;
  }

  .card-content,
  .print-card-content {
    margin: 0 !important;
  }
}

/* ===== LISTS ===== */
@media print {
  ul, ol {
    margin: 0 0 8pt 0 !important;
    padding-left: 20pt !important;
  }

  li {
    margin: 0 0 4pt 0 !important;
    page-break-inside: avoid !important;
  }

  .print-list {
    list-style: none !important;
    padding-left: 0 !important;
  }

  .print-list li {
    border-bottom: 1pt solid #eee !important;
    padding: 4pt 0 !important;
  }

  .print-list li:last-child {
    border-bottom: none !important;
  }
}

/* ===== PAGE BREAKS ===== */
@media print {
  .page-break-before {
    page-break-before: always !important;
  }

  .page-break-after {
    page-break-after: always !important;
  }

  .page-break-inside-avoid {
    page-break-inside: avoid !important;
  }

  .print-section {
    margin: 0 0 20pt 0 !important;
    page-break-inside: avoid !important;
  }

  /* Ensure tables don't break awkwardly */
  .schedule-table,
  .print-table {
    page-break-inside: avoid !important;
  }

  /* Break between major sections */
  .print-section + .print-section {
    page-break-before: always !important;
  }
}

/* ===== SPECIFIC COMPONENTS ===== */
@media print {
  /* Slot information */
  .slot-info {
    border: 1pt solid #000 !important;
    padding: 12pt !important;
    margin: 0 0 16pt 0 !important;
    page-break-inside: avoid !important;
  }

  .slot-info h3 {
    margin: 0 0 8pt 0 !important;
    font-size: 14pt !important;
  }

  .slot-info p {
    margin: 0 0 4pt 0 !important;
  }

  /* Teacher pools */
  .teacher-pool {
    margin: 0 0 12pt 0 !important;
    page-break-inside: avoid !important;
  }

  .teacher-pool h4 {
    margin: 0 0 6pt 0 !important;
    font-size: 12pt !important;
  }

  .teacher-list {
    display: grid !important;
    grid-template-columns: repeat(3, 1fr) !important;
    gap: 4pt !important;
    margin: 0 !important;
  }

  .teacher-item {
    padding: 2pt 4pt !important;
    border: 1pt solid #ccc !important;
    font-size: 10pt !important;
    text-align: center !important;
  }

  /* Constraints */
  .constraints-info {
    margin: 0 0 12pt 0 !important;
    page-break-inside: avoid !important;
  }

  .constraint-item {
    padding: 4pt 0 !important;
    border-bottom: 1pt solid #eee !important;
  }

  .constraint-item:last-child {
    border-bottom: none !important;
  }

  /* Metrics */
  .metrics-info {
    background: #f9f9f9 !important;
    border: 1pt solid #000 !important;
    padding: 8pt !important;
    margin: 0 0 12pt 0 !important;
    page-break-inside: avoid !important;
    font-size: 10pt !important;
  }

  .metrics-grid {
    display: grid !important;
    grid-template-columns: repeat(4, 1fr) !important;
    gap: 8pt !important;
  }

  .metric-item {
    text-align: center !important;
  }

  .metric-value {
    font-weight: 600 !important;
    font-size: 12pt !important;
  }

  .metric-label {
    font-size: 9pt !important;
    color: #666 !important;
  }
}

/* ===== ACCESSIBILITY IMPROVEMENTS ===== */
@media print {
  /* Ensure sufficient contrast */
  * {
    color: #000 !important;
  }

  /* Make links readable */
  a {
    color: #000 !important;
    text-decoration: underline !important;
  }

  /* Ensure table headers are clear */
  th {
    background: #f0f0f0 !important;
    font-weight: 700 !important;
  }

  /* Make important information stand out */
  .important {
    font-weight: 600 !important;
    background: #fff !important;
    border: 1pt solid #000 !important;
    padding: 2pt 4pt !important;
  }

  /* Ensure consistent spacing */
  .print-spacing {
    margin: 8pt 0 !important;
  }

  .print-spacing-small {
    margin: 4pt 0 !important;
  }

  .print-spacing-large {
    margin: 16pt 0 !important;
  }
}

/* ===== RESPONSIVE PRINT LAYOUT ===== */
@media print {
  /* Ensure tables fit on page */
  .schedule-table,
  .print-table {
    max-width: 100% !important;
    overflow: visible !important;
  }

  /* Stack elements vertically if needed */
  .print-stack {
    display: block !important;
  }

  .print-stack > * {
    display: block !important;
    width: 100% !important;
    margin: 0 0 8pt 0 !important;
  }

  /* Ensure text doesn't get cut off */
  .print-text {
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    hyphens: auto !important;
  }
}

/* ===== PRINT UTILITIES ===== */
@media print {
  .print-only {
    display: block !important;
  }

  .no-print {
    display: none !important;
  }

  .print-center {
    text-align: center !important;
  }

  .print-left {
    text-align: left !important;
  }

  .print-right {
    text-align: right !important;
  }

  .print-bold {
    font-weight: 700 !important;
  }

  .print-italic {
    font-style: italic !important;
  }

  .print-underline {
    text-decoration: underline !important;
  }
}